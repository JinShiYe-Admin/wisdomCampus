<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="../../css/mui.min.css" rel="stylesheet" />
		<link href="../../css/preview.css" rel="stylesheet" />
		<style type="text/css">
			
			body{
				background-color: #ffffff;
			}
			.mui-content{
				background-color: #ffffff;
			}
			
			.position{
				padding: 0 10px 0 15px;
				height: 50px;
			}
			.position>p{
				margin-top: 5px;
				margin-bottom: 5px;
				font-size: 14px;
				color: #0D0D0D;
				width: 90%;
				float: left;
			}
			
			.location-map{
				height: 300px;
			}
			
			#map {
				width: 100%;
				position: relative;
				bottom: 0px;
				line-height: 200px;
				text-align: center;
				background: #FFFFFF;
			}
			
			.mui-title {
				color: white;
			}
			.right-position{
				color: white;
				font-size: 15px;
				margin-top: 10px;
			}
			.select-color{
				color:#676767;
			}
			.refresh{
				color:#63BBFF;
				font-size: 20px;
				float: left;
				margin-bottom: 5px;
				margin-top: 15px;
				font-weight: 900;
			}
		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav" style="background-color:#63BBFF;"> 
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">新建审批</h1>
			<a id="position111" class="mui-pull-right right-position">查询</a>
		</header>
		 <div class="mui-content">
		 	<div class="mui-row">
		 		<div class="position">
		            <p id="curr-position" style="">
		              	正在获取当前位置...
		            </p>
		            <span onclick="refresh()" class="mui-icon mui-icon-loop refresh"></span>
		    	</div>
		 	</div>
		 	<div class="mui-row">
		 		<div id="map" class="location-map">地图加载中...</div>
		 	</div>
		 	<div class="mui-row">
		 		<form class="mui-input-group">
					<div class="mui-input-row">
						<label>考勤类型</label>
						<select class="select-color">
							<option>--考勤类型--</option>
							<option>上午上班</option>
							<option>上午下班</option>
							<option>下午上班</option>
							<option>下午下班</option>
						</select>
					</div>
					<div class="mui-input-row">
						<label>部门</label>
						<select class="select-color">
							<option>--选择部门--</option>
							<option>部门1</option>
							<option>部门2</option>
							<option>部门3</option>
							<option>很长很长很长很长很长很长的部门4</option>
						</select>
					</div>
					<div class="mui-input-row">
						<label>考勤地点</label>
						<select class="select-color">
							<option>--选择考勤地点--</option>
							<option>地点1</option>
							<option>地点2</option>
							<option>地点3</option>
							<option>很长很长很长很长很长很长很长很长很长很长很长很长很长很长的地点4</option>
						</select>
					</div>
				</form>
		 	</div>
		 	<div class="mui-row" style="    padding: 11px 15px;">
		 		 <p><a href="javascript:void(0);" onclick="getImage()" style="font-size: 15px;">上传照片</a> </p>
		 		 <img id="headimg" data-preview-src="" src="" style="display: none;" onclick="imgView()"  height="150"  width="150">
		 	</div>
		 </div>
		<script src="../../js/mui.min.js"></script>
		<script src="../../js/lib/vconsole/vconsole.min.js"></script>
		<script src="../../js/mui.zoom.js"></script>
		<script src="../../js/mui.previewimage.js"></script>
		
		<script type="text/javascript" src="http://api.map.baidu.com/api?v=3.0&ak=HnBMVcOKRZ5b8MdZp1sqxEPgvXkTeKfH"></script>
		
		<script type="text/javascript">
			mui.init();
				
			if(window.plus) {
				plusReady();
			} else {
				document.addEventListener("plusready", plusReady, false);
			}
			
			// H5 plus事件处理 
			function plusReady() {
				//获取当前位置 start
				plus.geolocation.getCurrentPosition( geoInf, function ( e ) {
					outSet( "获取定位位置信息失败："+e.message );
				},{geocode:true});
				//end
			}
			
			//百度地图定位
			var map = new BMap.Map("map");
			var point = new BMap.Point(116.331398,39.897445);
			map.centerAndZoom(point,15);
			refresh();
			
			//重新定位
			function refresh(){
				var geolocation = new BMap.Geolocation();
				geolocation.getCurrentPosition(function(r){
					if(this.getStatus() == BMAP_STATUS_SUCCESS){
						var mk = new BMap.Marker(r.point);
						map.addOverlay(mk);
						map.panTo(r.point);
					}
					else {
						alert('failed'+this.getStatus());
					}        
				});
				plus.geolocation.getCurrentPosition( geoInf, function ( e ) {
					outSet( "获取定位位置信息失败："+e.message );
				},{geocode:true});
			}
			
			//获取定位信息
			function geoInf( position ) {
				var curr_position=document.getElementById('curr-position');
				curr_position.innerHTML='当前位置：' + position.addresses;
			}			
			//拍照
			function getImage(){
				var cmr = plus.camera.getCamera();   
				cmr.captureImage(function(p){
					plus.io.resolveLocalFileSystemURL(p, function(entry){
						var img =  document.getElementById('headimg');
						img.style.display='inherit';
					    img.src=entry.toLocalURL();
					}, function(e){
						console.log('读取拍照文件错误：'+e.message);
					});
				}, function(e){
					console.log('失败：'+e.message);
				}, {filename:'_doc/camera/',index:1});
			}
			//预览图片
			function imgView(){
				var previewImage = mui.previewImage();
				previewImage.open(document.getElementById("headimg"));
			}
		</script>
	</body>

</html>